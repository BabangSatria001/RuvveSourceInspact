<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=0.8, user-scalable=no">
    <title>Satya AI - Asisten Pintar</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
            margin: 0;
            position: relative;
            overflow: hidden;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .container {
            background: #1e1e1e;
            border-radius: 0;
            box-shadow: none;
            max-width: 100%;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            border: none;
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @media (min-width: 768px) {
            body {
                padding: 20px;
                align-items: flex-start;
                padding-top: 40px;
            }
            
            .container {
                border-radius: 20px;
                box-shadow: 0 20px 60px rgba(0,0,0,0.5);
                max-width: 900px;
                height: auto;
                min-height: 500px;
                max-height: 80vh;
                border: 1px solid #333;
            }
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @media (min-width: 768px) {
            .header {
                padding: 25px;
            }
        }
        
        .hamburger-btn {
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            transition: all 0.3s ease;
        }

        .hamburger-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        @media (min-width: 768px) {
            .hamburger-btn {
                width: 50px;
                height: 50px;
                font-size: 28px;
            }
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.6s ease;
        }

        @media (min-width: 768px) {
            .header-left {
                gap: 20px;
            }
        }

.bot-icon {
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.6s ease;
            overflow: hidden;
        }
        
        .bot-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        @media (min-width: 768px) {
            .bot-icon {
                width: 60px;
                height: 60px;
                font-size: 32px;
            }
        }

        .header-info h1 {
            font-size: 22px;
            margin-bottom: 3px;
            transition: all 0.6s ease;
        }

        @media (min-width: 768px) {
            .header-info h1 {
                font-size: 28px;
                margin-bottom: 5px;
            }
        }

        .status {
            font-size: 12px;
            opacity: 0.9;
            transition: all 0.6s ease;
        }

        @media (min-width: 768px) {
            .status {
                font-size: 14px;
            }
        }

        .status.online { color: #4ade80; }
        .status.offline { color: #f87171; }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        @media (min-width: 768px) {
            .btn {
                padding: 12px 20px;
                font-size: 14px;
                gap: 8px;
            }
        }

        .btn-premium {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-premium:hover {
            transform: translateY(-2px);
        }

        .btn-premium.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .sidebar {
            position: fixed;
            left: -320px;
            top: 0;
            width: 320px;
            height: 100vh;
            background: #1e1e1e;
            z-index: 1000;
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            box-shadow: 5px 0 30px rgba(0,0,0,0.5);
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .sidebar-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-header h2 {
            font-size: 24px;
        }

        .close-sidebar {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-sidebar:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #1a1a1a;
        }

        .sidebar-content::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar-content::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        .sidebar-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }

        .nav-section {
            margin-bottom: 30px;
        }

        .nav-section h3 {
            color: #888;
            font-size: 14px;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-item {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
        }

        .nav-item:hover {
            background: #3d3d3d;
            transform: translateX(5px);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .nav-item-icon {
            font-size: 20px;
        }

        .chat-history-item {
            background: #2d2d2d;
            padding: 12px 15px;
            border-radius: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }

        .chat-history-item:hover {
            background: #3d3d3d;
            transform: translateX(5px);
        }

        .chat-history-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .chat-title {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .delete-chat-btn {
            background: rgba(239, 68, 68, 0.2);
            border: none;
            color: #ef4444;
            width: 30px;
            height: 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .delete-chat-btn:hover {
            background: rgba(239, 68, 68, 0.4);
        }

        .btn-new-chat {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 15px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .btn-new-chat:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.4);
        }

        .setting-section {
            display: none;
        }

        .setting-section.active {
            display: block;
        }

        .setting-group {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .setting-group label {
            display: block;
            color: #888;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .setting-group input {
            width: 100%;
            padding: 12px;
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            outline: none;
        }

        .setting-group input:focus {
            border-color: #667eea;
        }
        
        .about-group {
            margin-bottom: 10px;
        }

        .about-link {
            background: #2d2d2d;
            padding: 15px 18px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .about-link:hover {
            background: #3d3d3d;
            transform: translateX(5px);
        }

        .about-icon {
            font-size: 20px;
            width: 30px;
            text-align: center;
        }

        .about-link span:nth-child(2) {
            flex: 1;
            font-size: 14px;
            font-weight: 500;
        }

        .about-arrow {
            font-size: 18px;
            opacity: 0.6;
        }

        .whatsapp-link:hover {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
        }
        
        .donate-link:hover {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
        }

        .btn-save {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-delete-all {
            background: #ef4444;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .btn-delete-all:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            padding-bottom: 10px;
            background: #1a1a1a;
            min-height: 200px;
            max-height: calc(100vh - 280px);
            -webkit-overflow-scrolling: touch;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @media (min-width: 768px) {
            .chat-container {
                padding: 20px;
                padding-bottom: 15px;
                max-height: calc(80vh - 220px);
            }
        }

        .chat-container::-webkit-scrollbar {
            width: 8px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }

        .message {
            margin-bottom: 20px;
            display: flex;
            gap: 12px;
            transition: all 0.6s ease;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 22px;
            transition: all 0.6s ease;
            overflow: hidden;
        }
        
        .message-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .message.user .message-avatar {
            background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%);
        }

        .message.ai .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .message-content {
            max-width: 75%;
            padding: 12px 16px;
            border-radius: 16px;
            line-height: 1.5;
            font-size: 14px;
            word-wrap: break-word;
            transition: all 0.6s ease;
        }

        @media (min-width: 768px) {
            .message-content {
                max-width: 70%;
                padding: 16px 20px;
                font-size: 15px;
                line-height: 1.6;
            }
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.ai .message-content {
            background: #2d2d2d;
            color: #e0e0e0;
            border-bottom-left-radius: 4px;
        }

        .loading {
            display: none;
        }

        .loading.show {
            display: flex;
            gap: 12px;
        }

        .loading-dots {
            background: #2d2d2d;
            padding: 14px 18px;
            border-radius: 16px;
            border-bottom-left-radius: 4px;
            display: flex;
            gap: 6px;
        }

        .loading-dots span {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        .input-area {
            padding: 15px;
            background: #1e1e1e;
            border-top: 1px solid #333;
            flex-shrink: 0;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @media (min-width: 768px) {
            .input-area {
                padding: 20px;
            }
        }

        .input-container {
            display: flex;
            gap: 10px;
        }

        @media (min-width: 768px) {
            .input-container {
                gap: 12px;
            }
        }

#userInput {
            flex: 1;
            padding: 12px 16px;
            background: #2d2d2d;
            border: 1px solid #444;
            border-radius: 12px;
            color: white;
            font-size: 14px;
            outline: none;
            transition: all 0.6s ease;
            resize: none; /* Disable manual resize */
            min-height: 48px;
            max-height: 120px;
            overflow-y: auto;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.5;
        }
        @media (min-width: 768px) {
            #userInput {
                padding: 14px 18px;
                font-size: 15px;
            }
        }

        #userInput:focus {
            border-color: #667eea;
        }

        #sendBtn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        @media (min-width: 768px) {
            #sendBtn {
                padding: 14px 28px;
                font-size: 15px;
                gap: 8px;
            }
        }

        #sendBtn:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.05);
        }

        #sendBtn:disabled {
            background: #444;
            cursor: not-allowed;
            transform: none;
            opacity: 0.5;
        }
/* PREMIUM MODE */
        body.premium-mode {
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            background-size: 400% 400%;
            animation: gradientWave 15s ease infinite;
        }

        @keyframes gradientWave {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        body.premium-mode .container {
            background: linear-gradient(145deg, rgba(15, 12, 41, 0.9), rgba(36, 36, 62, 0.9));
            backdrop-filter: blur(40px);
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 30px 90px rgba(102, 126, 234, 0.3), inset 0 0 100px rgba(102, 126, 234, 0.05);
        }

        body.premium-mode .header {
            background: linear-gradient(145deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            backdrop-filter: blur(20px);
            border-bottom: 2px solid rgba(102, 126, 234, 0.3);
            padding: 20px 25px;
            box-shadow: 0 5px 30px rgba(102, 126, 234, 0.2);
        }

        body.premium-mode .header-left {
            flex-direction: column;
            align-items: flex-start;
            gap: 15px;
        }

        body.premium-mode .bot-icon {
            width: 60px;
            height: 60px;
            font-size: 32px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 0 40px rgba(102, 126, 234, 0.6), 0 0 80px rgba(118, 75, 162, 0.4);
            animation: float 3s ease-in-out infinite;
        }
        
        body.premium-mode .hamburger-btn {
            background: rgba(102, 126, 234, 0.3);
            border: 2px solid rgba(102, 126, 234, 0.5);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.4);
        }

        body.premium-mode .hamburger-btn:hover {
            background: rgba(102, 126, 234, 0.5);
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.6);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        body.premium-mode .header-info h1 {
            font-size: 24px;
            background: linear-gradient(135deg, #667eea, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        body.premium-mode .status {
            font-size: 14px;
            color: #4ade80;
            text-shadow: 0 0 10px rgba(74, 222, 128, 0.8);
        }

        body.premium-mode .chat-container {
            background: rgba(15, 12, 41, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            margin: 20px;
            margin-bottom: 10px;
            padding: 25px;
            border: 1px solid rgba(102, 126, 234, 0.2);
            box-shadow: inset 0 0 50px rgba(102, 126, 234, 0.05);
            max-height: calc(100vh - 380px);
        }

        @media (min-width: 768px) {
            body.premium-mode .chat-container {
                max-height: calc(80vh - 350px);
            }
        }

        body.premium-mode .chat-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        body.premium-mode .message-avatar {
            width: 50px;
            height: 50px;
            font-size: 26px;
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.8);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 30px rgba(102, 126, 234, 0.8); }
            50% { box-shadow: 0 0 50px rgba(102, 126, 234, 1); }
        }

        body.premium-mode .message.user .message-avatar {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            box-shadow: 0 0 30px rgba(240, 147, 251, 0.8);
        }

        body.premium-mode .message.ai .message-avatar {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        body.premium-mode .message-content {
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        body.premium-mode .message.user .message-content {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.3), rgba(245, 87, 108, 0.3));
            border-bottom-right-radius: 5px;
            box-shadow: 0 5px 25px rgba(240, 147, 251, 0.3);
        }

        body.premium-mode .message.ai .message-content {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            border-bottom-left-radius: 5px;
            box-shadow: 0 5px 25px rgba(102, 126, 234, 0.3);
        }

        body.premium-mode .loading-dots {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 5px 25px rgba(102, 126, 234, 0.3);
        }

        body.premium-mode .loading-dots span {
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.8);
        }

        body.premium-mode .input-area {
            background: linear-gradient(145deg, rgba(15, 12, 41, 0.8), rgba(36, 36, 62, 0.8));
            backdrop-filter: blur(30px);
            border-top: 2px solid rgba(102, 126, 234, 0.3);
            padding: 20px;
            box-shadow: 0 -5px 30px rgba(102, 126, 234, 0.2);
            margin: 0 20px 20px 20px;
            border-radius: 20px;
        }

        @media (max-width: 767px) {
            body.premium-mode .input-area {
                margin: 0 15px 15px 15px;
                padding: 15px;
            }
            body.premium-mode .bot-icon {
                width: 60px;
                height: 60px;
                font-size: 30px;
            }
            body.premium-mode .bot-icon:
            body.premium-mode .hamburger-btn {
                width: 45px;
                height: 45px;
                font-size: 24px;
            }
            body.premium-mode .header-left {
            flex-direction: row;
            align-items: center;
            gap: 15px;
        }
            body.premium-mode .header {
                padding: 20px;
            }
            body.premium-mode .chat-container {
                margin: 15px;
                margin-bottom: 5px;
                padding: 15px;
                max-height: calc(100vh - 360px);
            }
        }

        body.premium-mode #userInput {
            background: rgba(15, 12, 41, 0.6);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(102, 126, 234, 0.4);
            border-radius: 20px;
            color: white;
            font-size: 15px;
            padding: 14px 20px;
            box-shadow: inset 0 0 20px rgba(102, 126, 234, 0.1);
        }

        @media (max-width: 767px) {
            body.premium-mode #userInput {
                font-size: 14px;
                padding: 12px 16px;
            }
        }

        body.premium-mode #userInput:focus {
            border-color: #667eea;
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.5), inset 0 0 20px rgba(102, 126, 234, 0.2);
        }

        body.premium-mode #sendBtn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 20px;
            padding: 14px 28px;
            font-size: 15px;
            box-shadow: 0 5px 25px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }

        @media (max-width: 767px) {
            body.premium-mode #sendBtn {
                padding: 12px 20px;
                font-size: 14px;
            }
        }

        body.premium-mode #sendBtn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        body.premium-mode #sendBtn:hover:not(:disabled)::before {
            left: 100%;
        }

        body.premium-mode #sendBtn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 35px rgba(102, 126, 234, 0.6);
        }

        body.premium-mode .sidebar {
            background: linear-gradient(145deg, rgba(15, 12, 41, 0.95), rgba(36, 36, 62, 0.95));
            backdrop-filter: blur(40px);
            border-right: 2px solid rgba(102, 126, 234, 0.4);
            box-shadow: 5px 0 50px rgba(102, 126, 234, 0.3);
        }
        
        body.premium-mode .sidebar-header {
            background: linear-gradient(145deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            backdrop-filter: blur(20px);
            border-bottom: 2px solid rgba(102, 126, 234, 0.4);
            box-shadow: 0 5px 30px rgba(102, 126, 234, 0.2);
        }
        
        body.premium-mode .sidebar-header h2 {
            background: linear-gradient(135deg, #667eea, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        body.premium-mode .close-sidebar {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid rgba(239, 68, 68, 0.4);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
        }
        
        body.premium-mode .close-sidebar:hover {
            background: rgba(239, 68, 68, 0.4);
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.5);
        }
        
        body.premium-mode .sidebar-content {
            background: rgba(15, 12, 41, 0.4);
        }
        
        body.premium-mode .nav-item {
            background: rgba(15, 12, 41, 0.6);
            border: 1px solid rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(10px);
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.3);
        }
        
        body.premium-mode .nav-item:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 0 5px 25px rgba(102, 126, 234, 0.4);
            transform: translateX(5px);
        }
        
        body.premium-mode .nav-item.active {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.4), rgba(118, 75, 162, 0.4));
            border-color: rgba(102, 126, 234, 0.6);
            box-shadow: 0 5px 30px rgba(102, 126, 234, 0.5);
        }
        
        body.premium-mode .chat-history-item {
            background: rgba(15, 12, 41, 0.6);
            border: 1px solid rgba(102, 126, 234, 0.2);
            backdrop-filter: blur(10px);
        }
        
        body.premium-mode .chat-history-item:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            border-color: rgba(102, 126, 234, 0.4);
            box-shadow: 0 3px 20px rgba(102, 126, 234, 0.3);
            transform: translateX(5px);
        }
        
        body.premium-mode .chat-history-item.active {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 0 3px 25px rgba(102, 126, 234, 0.4);
        }
        
        body.premium-mode .delete-chat-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        body.premium-mode .delete-chat-btn:hover {
            background: rgba(239, 68, 68, 0.4);
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.5);
        }
        
        body.premium-mode .setting-group {
            background: rgba(15, 12, 41, 0.6);
            border: 1px solid rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(10px);
            box-shadow: 0 3px 20px rgba(0, 0, 0, 0.3);
        }
        
        body.premium-mode .setting-group label {
            color: #a78bfa;
        }
        
        body.premium-mode .setting-group input {
            background: rgba(15, 12, 41, 0.8);
            border: 2px solid rgba(102, 126, 234, 0.4);
            color: white;
            backdrop-filter: blur(10px);
        }
        
        body.premium-mode .setting-group input:focus {
            border-color: #667eea;
            box-shadow: 0 0 25px rgba(102, 126, 234, 0.5);
        }
        
        body.premium-mode .btn-save,
        body.premium-mode .btn-delete-all,
        body.premium-mode .btn-new-chat {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: 2px solid rgba(102, 126, 234, 0.5);
            box-shadow: 0 5px 25px rgba(102, 126, 234, 0.4);
        }
        
        body.premium-mode .btn-save:hover,
        body.premium-mode .btn-delete-all:hover,
        body.premium-mode .btn-new-chat:hover {
            box-shadow: 0 8px 35px rgba(102, 126, 234, 0.6);
            transform: translateY(-2px);
        }
        
        body.premium-mode .btn-delete-all {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.8), rgba(220, 38, 38, 0.8));
            border-color: rgba(239, 68, 68, 0.6);
        }
        
        body.premium-mode .btn-delete-all:hover {
            box-shadow: 0 8px 35px rgba(239, 68, 68, 0.6);
        }
        
        body.premium-mode .about-link {
            background: rgba(15, 12, 41, 0.6);
            border: 1px solid rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(10px);
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.3);
        }
        
        body.premium-mode .about-link:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 0 5px 25px rgba(102, 126, 234, 0.4);
            transform: translateX(5px);
        }
        
        body.premium-mode .whatsapp-link:hover {
            background: linear-gradient(135deg, rgba(37, 211, 102, 0.4), rgba(18, 140, 126, 0.4));
            border-color: rgba(37, 211, 102, 0.6);
            box-shadow: 0 5px 25px rgba(37, 211, 102, 0.4);
        }
        body.premium-mode .donate-link:hover {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.4), rgba(255, 142, 83, 0.4));
            border-color: rgba(255, 107, 107, 0.6);
            box-shadow: 0 5px 25px rgba(255, 107, 107, 0.4);
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0;
            transition: opacity 0.8s ease;
        }

        body.premium-mode .particles {
            opacity: 1;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.8), transparent);
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.6);
        }
    </style>
</head>
<body>
<div class="particles" id="particles"></div>
    
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
    
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>‚ò∞ Menu</h2>
            <button class="close-sidebar" onclick="toggleSidebar()">‚úï</button>
        </div>
        
        <div class="sidebar-content">
            <button class="btn-new-chat" onclick="createNewChat()">
                ‚ûï Chat Baru
            </button>
            
            <div class="nav-section">
                <h3>Navigation</h3>
                <div class="nav-item active" id="navChats" onclick="switchView('chats')">
                    <span class="nav-item-icon">üí¨</span>
                    <span>Riwayat Chat</span>
                </div>
                <div class="nav-item" id="navAbout" onclick="switchView('about')">
                    <span class="nav-item-icon">‚ÑπÔ∏è</span>
                    <span>Tentang</span>
                </div>
            </div>
            
            <!-- Chat History Section -->
            <div class="nav-section" id="chatHistorySection">
                <h3>Chat Sessions</h3>
                <div id="chatHistoryList">
                    <!-- Chat history akan dimuat di sini -->
                </div>
            </div>
            
<!-- About Section -->
            <div class="setting-section" id="aboutSection">
                <h3 style="color: #888; font-size: 14px; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;">Tentang</h3>
                
                <div class="about-group">
                    <a href="404/index.html" class="about-link">
                        <span class="about-icon">üìñ</span>
                        <span>Bantuan</span>
                        <span class="about-arrow">‚Üí</span>
                    </a>
                </div>
                
                <div class="about-group">
                    <a href="404/index.html" class="about-link">
                        <span class="about-icon">üìã</span>
                        <span>Ketentuan Pengguna</span>
                        <span class="about-arrow">‚Üí</span>
                    </a>
                </div>
                
                <div class="about-group">
                    <a href="404/index.html" class="about-link">
                        <span class="about-icon">üîí</span>
                        <span>Kebijakan Privasi</span>
                        <span class="about-arrow">‚Üí</span>
                    </a>
                </div>
                
                <div class="about-group">
                    <a href="404/index.html" class="about-link">
                        <span class="about-icon">‚öñÔ∏è</span>
                        <span>Lisensi</span>
                        <span class="about-arrow">‚Üí</span>
                    </a>
                </div>
                
                <h3 style="color: #888; font-size: 14px; margin: 25px 0 15px 0; text-transform: uppercase; letter-spacing: 1px;">Hubungi Kami</h3>
                
                <div class="about-group">
                    <a href="https://wa.me/6283867489829" target="_blank" class="about-link whatsapp-link">
                        <span class="about-icon">üì±</span>
                        <span>WhatsApp</span>
                        <span class="about-arrow">‚Üí</span>
                    </a>
                </div>
                
                <div class="about-group">
                    <a href="404/index.html" class="about-link donate-link">
                        <span class="about-icon">üíù</span>
                        <span>Donate</span>
                        <span class="about-arrow">‚Üí</span>
                    </a>
                </div>
                
                <div class="setting-group" style="margin-top: 25px;">
                    <label>Hapus Semua Chat</label>
                    <p style="color: #888; font-size: 12px; margin-bottom: 10px;">Menghapus semua riwayat chat tidak dapat dibatalkan!</p>
                    <button class="btn-delete-all" onclick="deleteAllChats()">üóëÔ∏è Hapus Semua Chat</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="header">
            <div class="header-left">
                <button class="hamburger-btn" onclick="toggleSidebar()">‚ò∞</button>
                <div class="bot-icon">
                    <img src="icon.png" alt="Satya AI" onerror="this.style.display='none'; this.parentElement.innerHTML='ü§ñ';">
                </div>
                <div class="header-info">
                    <h1 id="botName">Satya AI</h1>
                    <p class="status offline" id="status">üî¥ Need Activation</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-premium" id="premiumBtn" onclick="togglePremiumUI()">
                    ‚ú® Premium
                </button>
            </div>
        </div>

        <div class="chat-container" id="chatContainer">
            <div class="message ai">
                <div class="message-avatar">
                    <img src="icon.png" alt="AI" onerror="this.style.display='none'; this.parentElement.innerHTML='ü§ñ';">
                </div>
                <div class="message-content">
                    Halo! üëã Aku Satya, asisten pintar buatan MAMAS Satria!<br><br>
                    <strong>Klik tombol di bawah untuk aktivasi:</strong>
                </div>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button onclick="activateAI()" style="padding: 15px 40px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4); transition: all 0.3s;">
                    ‚ö° Aktifkan Satya AI
                </button>
            </div>
        </div>

<div class="input-area">
            <div class="input-container">
                <textarea id="userInput" placeholder="Ketik pesan kamu di sini... (Shift+Enter untuk kirim)" disabled rows="1"></textarea>
                <button id="sendBtn" onclick="sendMessage()" disabled>
                    ‚û§ Kirim
                </button>
            </div>
        </div>
    </div>
    
    
<script>
        const MASTER_API_KEY = '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';
        
        let apiKey = localStorage.getItem('groqApiKey') || '';
        let isActivated = localStorage.getItem('aiActivated') === 'true';
        let isPremiumUI = localStorage.getItem('premiumUI') === 'true';
        let isTyping = false; // Flag untuk cek apakah sedang typing
        
        // Multi-chat management
        let chatSessions = JSON.parse(localStorage.getItem('chatSessions')) || [];
        let currentChatId = localStorage.getItem('currentChatId') || null;
        
        // Jika belum ada chat, buat chat pertama
        if (chatSessions.length === 0) {
            currentChatId = createNewChatSession();
        }

        window.onload = function() {
            if (isActivated && apiKey) {
                document.getElementById('status').textContent = 'üü¢ Online';
                document.getElementById('status').className = 'status online';
                document.getElementById('userInput').disabled = false;
                document.getElementById('sendBtn').disabled = false;
            }
            
            if (isPremiumUI) {
                document.body.classList.add('premium-mode');
                document.getElementById('premiumBtn').classList.add('active');
                document.getElementById('premiumBtn').innerHTML = '‚úì Premium ON';
                createParticles();
            }
            
            // Load chat history
            loadChatHistory();
            
            // Load current chat
            if (currentChatId) {
                loadChat(currentChatId);
            }
        };
        
        // ========== SIDEBAR FUNCTIONS ==========
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }
        
        function switchView(view) {
            const navChats = document.getElementById('navChats');
            const navAbout = document.getElementById('navAbout');
            const chatHistorySection = document.getElementById('chatHistorySection');
            const aboutSection = document.getElementById('aboutSection');
            
            if (view === 'chats') {
                navChats.classList.add('active');
                navAbout.classList.remove('active');
                chatHistorySection.style.display = 'block';
                aboutSection.classList.remove('active');
            } else if (view === 'about') {
                navAbout.classList.add('active');
                navChats.classList.remove('active');
                chatHistorySection.style.display = 'none';
                aboutSection.classList.add('active');
            }
        }
        
        // ========== CHAT SESSION MANAGEMENT ==========
        function createNewChatSession() {
            const chatId = 'chat_' + Date.now();
            const newChat = {
                id: chatId,
                title: 'Chat Baru',
                messages: [],
                createdAt: new Date().toISOString()
            };
            
            chatSessions.push(newChat);
            localStorage.setItem('chatSessions', JSON.stringify(chatSessions));
            
            return chatId;
        }
        
        function createNewChat() {
            // Save current chat first
            if (currentChatId) {
                saveCurrentChat();
            }
            
            // Create new chat
            currentChatId = createNewChatSession();
            localStorage.setItem('currentChatId', currentChatId);
            
            // Clear chat container
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.innerHTML = '';
            
            // Add welcome message
            if (isActivated) {
                addMessageWithTyping('ai', 'Halo! üëã Ini chat baru. Ada yang bisa aku bantu? üòä');
            } else {
                chatContainer.innerHTML = `
                    <div class="message ai">
                        <div class="message-avatar">
                            <img src="icon.png" alt="AI" onerror="this.style.display='none'; this.parentElement.innerHTML='ü§ñ';">
                        </div>
                        <div class="message-content">
                            Halo! üëã Aku Satya, asisten pintar buatan MAMAS Satria!<br><br>
                            <strong>Klik tombol di bawah untuk aktivasi:</strong>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="activateAI()" style="padding: 15px 40px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4); transition: all 0.3s;">
                            ‚ö° Aktifkan Satya AI
                        </button>
                    </div>
                `;
            }
            
            // Reload chat history
            loadChatHistory();
            
            // Close sidebar
            toggleSidebar();
        }
        
        function saveCurrentChat() {
            if (!currentChatId) return;
            
            const chatIndex = chatSessions.findIndex(c => c.id === currentChatId);
            if (chatIndex === -1) return;
            
            // Get all messages from chat container
            const messages = [];
            const messageElements = document.querySelectorAll('.message');
            
            messageElements.forEach(el => {
                const role = el.classList.contains('user') ? 'user' : 'ai';
                const content = el.querySelector('.message-content').innerHTML;
                messages.push({ role, content });
            });
            
            chatSessions[chatIndex].messages = messages;
            
            // Update title based on first user message
            if (messages.length > 0) {
                const firstUserMsg = messages.find(m => m.role === 'user');
                if (firstUserMsg) {
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = firstUserMsg.content;
                    const text = tempDiv.textContent || tempDiv.innerText;
                    chatSessions[chatIndex].title = text.substring(0, 30) + (text.length > 30 ? '...' : '');
                }
            }
            
            localStorage.setItem('chatSessions', JSON.stringify(chatSessions));
        }
        
        function loadChat(chatId) {
            // Save current chat before switching
            if (currentChatId && currentChatId !== chatId) {
                saveCurrentChat();
            }
            
            currentChatId = chatId;
            localStorage.setItem('currentChatId', currentChatId);
            
            const chat = chatSessions.find(c => c.id === chatId);
            if (!chat) return;
            
            // Clear chat container
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.innerHTML = '';
            
            // Load messages
            if (chat.messages.length === 0) {
                if (isActivated) {
                    addMessage('ai', 'Halo! üëã Ada yang bisa aku bantu? üòä');
                } else {
                    chatContainer.innerHTML = `
                        <div class="message ai">
                            <div class="message-avatar">
                                <img src="icon.png" alt="AI" onerror="this.style.display='none'; this.parentElement.innerHTML='ü§ñ';">
                            </div>
                            <div class="message-content">
                                Halo! üëã Aku Satya, asisten pintar buatan MAMAS Satria!<br><br>
                                <strong>Klik tombol di bawah untuk aktivasi:</strong>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="activateAI()" style="padding: 15px 40px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4); transition: all 0.3s;">
                                ‚ö° Aktifkan Satya AI
                            </button>
                        </div>
                    `;
                }
            } else {
                chat.messages.forEach(msg => {
                    addMessage(msg.role, msg.content);
                });
            }
            
            // Update chat history UI
            loadChatHistory();
            
            // Close sidebar
            if (window.innerWidth < 768) {
                toggleSidebar();
            }
        }
        
        function loadChatHistory() {
            const chatHistoryList = document.getElementById('chatHistoryList');
            chatHistoryList.innerHTML = '';
            
            if (chatSessions.length === 0) {
                chatHistoryList.innerHTML = '<p style="color: #888; text-align: center; padding: 20px;">Belum ada chat</p>';
                return;
            }
            
            // Sort by date (newest first)
            const sortedChats = [...chatSessions].sort((a, b) => 
                new Date(b.createdAt) - new Date(a.createdAt)
            );
            
            sortedChats.forEach(chat => {
                const chatItem = document.createElement('div');
                chatItem.className = 'chat-history-item';
                if (chat.id === currentChatId) {
                    chatItem.classList.add('active');
                }
                
                chatItem.innerHTML = `
                    <span class="chat-title" onclick="loadChat('${chat.id}')">${chat.title}</span>
                    <button class="delete-chat-btn" onclick="deleteChat('${chat.id}', event)">üóëÔ∏è</button>
                `;
                
                chatHistoryList.appendChild(chatItem);
            });
        }
        
        function deleteChat(chatId, event) {
            event.stopPropagation();
            
            if (!confirm('Yakin mau hapus chat ini?')) return;
            
            chatSessions = chatSessions.filter(c => c.id !== chatId);
            localStorage.setItem('chatSessions', JSON.stringify(chatSessions));
            
            // If deleted current chat, create new one
            if (chatId === currentChatId) {
                if (chatSessions.length > 0) {
                    loadChat(chatSessions[0].id);
                } else {
                    createNewChat();
                }
            }
            
            loadChatHistory();
        }
        
        function deleteAllChats() {
            if (!confirm('‚ö†Ô∏è YAKIN mau hapus SEMUA chat? Ini tidak bisa dibatalkan!')) return;
            
            chatSessions = [];
            localStorage.setItem('chatSessions', JSON.stringify(chatSessions));
            
            // Create new chat
            createNewChat();
        }
        
// ========== PREMIUM UI FUNCTIONS ==========
        function togglePremiumUI() {
            const body = document.body;
            const btn = document.getElementById('premiumBtn');
            
            if (body.classList.contains('premium-mode')) {
                // Deactivate Premium
                body.classList.remove('premium-mode');
                btn.classList.remove('active');
                btn.innerHTML = '‚ú® Premium';
                localStorage.setItem('premiumUI', 'false');
                
                // Animate out
                const messages = document.querySelectorAll('.message');
                messages.forEach((msg, i) => {
                    setTimeout(() => {
                        msg.style.opacity = '0';
                        msg.style.transform = 'scale(0.95)';
                    }, i * 50);
                });
                
                setTimeout(() => {
                    messages.forEach(msg => {
                        msg.style.opacity = '1';
                        msg.style.transform = 'scale(1)';
                    });
                }, 600);
                
            } else {
                // Activate Premium
                body.classList.add('premium-mode');
                btn.classList.add('active');
                btn.innerHTML = '‚úì Premium ON';
                localStorage.setItem('premiumUI', 'true');
                createParticles();
                
                // Animate in
                const messages = document.querySelectorAll('.message');
                messages.forEach((msg, i) => {
                    msg.style.opacity = '0';
                    msg.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        msg.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                        msg.style.opacity = '1';
                        msg.style.transform = 'translateY(0)';
                    }, i * 100 + 300);
                });
            }
        }
        
        function createParticles() {
            const container = document.getElementById('particles');
            container.innerHTML = '';
            
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                const duration = Math.random() * 20 + 10;
                const delay = Math.random() * 5;
                const size = Math.random() * 3 + 2;
                
                particle.style.left = x + '%';
                particle.style.top = y + '%';
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                particle.style.animation = `floatParticle ${duration}s ${delay}s infinite ease-in-out`;
                
                container.appendChild(particle);
            }
            
            // Add animation keyframes
            if (!document.getElementById('particle-animation')) {
                const style = document.createElement('style');
                style.id = 'particle-animation';
                style.textContent = `
                    @keyframes floatParticle {
                        0%, 100% {
                            transform: translate(0, 0) scale(1);
                            opacity: 0.3;
                        }
                        25% {
                            transform: translate(20px, -30px) scale(1.2);
                            opacity: 0.8;
                        }
                        50% {
                            transform: translate(-20px, -60px) scale(1);
                            opacity: 0.5;
                        }
                        75% {
                            transform: translate(30px, -30px) scale(1.1);
                            opacity: 0.7;
                        }
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // ========== AI ACTIVATION ==========
        function activateAI() {
            if (MASTER_API_KEY === 'gsk_TARUH_API_KEY_KAMU_DISINI') {
                addMessage('ai', '‚ö†Ô∏è Owner belum setting API Key! Hubungi yang share file ini ya.');
                return;
            }
            
            apiKey = MASTER_API_KEY;
            localStorage.setItem('groqApiKey', apiKey);
            localStorage.setItem('aiActivated', 'true');
            isActivated = true;
            
            document.getElementById('status').textContent = 'üü¢ Online';
            document.getElementById('status').className = 'status online';
            document.getElementById('userInput').disabled = false;
            document.getElementById('sendBtn').disabled = false;
            
            // Clear container and add activation message
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.innerHTML = '';
            
            addMessageWithTyping('ai', 'üéâ Satya AI berhasil diaktifkan! Sekarang kamu bisa ngobrol bebas. Selamat datang! üòä<br><br>üí° <strong>Tips:</strong> Coba klik tombol <strong>‚ú® Premium</strong> di atas untuk tampilan UI yang lebih keren!');
            
            // Save to current chat
            saveCurrentChat();
        }

// ========== MESSAGE FUNCTIONS ==========
        function addMessage(role, content) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            // Format content: ganti \n jadi <br>
            const formattedContent = content.replace(/\n/g, '<br>');
            
            const avatar = role === 'user' ? 'üë§' : '<img src="icon.png" alt="AI" onerror="this.style.display=\'none\'; this.parentElement.innerHTML=\'ü§ñ\';">';
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">${formattedContent}</div>
            `;
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
        function addMessageWithTyping(role, content) {
            isTyping = true; // Set flag typing
            disableInput(); // Disable input saat typing
            
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            const avatar = role === 'user' ? 'üë§' : '<img src="icon.png" alt="AI" onerror="this.style.display=\'none\'; this.parentElement.innerHTML=\'ü§ñ\';">';
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            messageDiv.innerHTML = `<div class="message-avatar">${avatar}</div>`;
            messageDiv.appendChild(contentDiv);
            chatContainer.appendChild(messageDiv);
            
            let index = 0;
            const speed = 5;
            
            function typeWriter() {
                if (index < content.length) {
                    if (content[index] === '<') {
                        const closeTag = content.indexOf('>', index);
                        if (closeTag !== -1) {
                            contentDiv.innerHTML += content.substring(index, closeTag + 1);
                            index = closeTag + 1;
                        } else {
                            contentDiv.innerHTML += content[index];
                            index++;
                        }
                    } else {
                        contentDiv.innerHTML += content[index];
                        index++;
                    }
                    
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                    setTimeout(typeWriter, speed);
                } else {
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                    isTyping = false; // Selesai typing
                    enableInput(); // Enable input lagi
                    saveCurrentChat(); // Save chat setelah selesai typing
                }
            }
            
            typeWriter();
        }

        function showLoading() {
            const chatContainer = document.getElementById('chatContainer');
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'loading show';
            loadingDiv.id = 'loading-indicator';
            loadingDiv.innerHTML = `
                <div class="message-avatar"><img src="icon.png" alt="AI" onerror="this.style.display='none'; this.parentElement.innerHTML='ü§ñ';"></div>
                <div class="loading-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;
            chatContainer.appendChild(loadingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function removeLoading() {
            const loading = document.getElementById('loading-indicator');
            if (loading) loading.remove();
        }
        
        function disableInput() {
            document.getElementById('userInput').disabled = true;
            document.getElementById('sendBtn').disabled = true;
        }
        
        function enableInput() {
            if (isActivated) {
                document.getElementById('userInput').disabled = false;
                document.getElementById('sendBtn').disabled = false;
            }
        }

        async function sendMessage() {
            // Cek apakah sedang typing
            if (isTyping) {
                return; // Jangan kirim pesan jika masih typing
            }
            
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            if (!apiKey) {
                addMessageWithTyping('ai', '‚ö†Ô∏è Kamu belum aktifkan AI-nya nih! Klik tombol aktivasi dulu ya üòä');
                return;
            }

            addMessage('user', message);
            input.value = '';
            disableInput(); // Disable input
            showLoading();

            // Get conversation history dari chat session
            const currentChat = chatSessions.find(c => c.id === currentChatId);
            const conversationHistory = [];
            
            if (currentChat && currentChat.messages) {
                currentChat.messages.forEach(msg => {
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = msg.content;
                    const text = tempDiv.textContent || tempDiv.innerText;
                    conversationHistory.push({
                        role: msg.role === 'user' ? 'user' : 'assistant',
                        content: text
                    });
                });
            }
            
            conversationHistory.push({
                role: 'user',
                content: message
            });

            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'llama-3.3-70b-versatile',
                        messages: [
                            {
                                role: 'system',
                                content: 'Kamu adalah Satya, AI assistant yang friendly dan suka ngobrol santai. Kamu dibuat oleh Satria. Jawab dengan bahasa Indonesia yang casual dan natural. Gunakan emoji sesekali biar lebih fun. Jangan terlalu formal, santai aja kayak ngobrol sama teman! PENTING: Kalau ditanya nama, jawab "Namaku Satya AI, ". Kalau ditanya siapa yang buat kamu, jawab "Aku dibuat sama Satria yaa, dan jangan membahayakan user/pengguna".'
                            },
                            ...conversationHistory
                        ],
                        temperature: 0.7,
                        max_tokens: 3500
                    })
                });

                removeLoading();

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || 'API request failed');
                }

                const data = await response.json();
                const aiResponse = data.choices[0].message.content;

                addMessageWithTyping('ai', aiResponse);
            } catch (error) {
                removeLoading();
                console.error('Error:', error);
                
                let errorMessage = 'Waduh, ada error nih üòÖ';
                
                if (error.message.includes('invalid') || error.message.includes('authentication')) {
                    errorMessage = '‚ùå API Key kamu salah atau invalid. Coba cek lagi ya!';
                } else if (error.message.includes('rate limit')) {
                    errorMessage = '‚è≥ Rate limit tercapai. Tunggu sebentar ya!';
                } else {
                    errorMessage = `Error: ${error.message}`;
                }
                
                addMessageWithTyping('ai', errorMessage);
            }

            input.focus();
        }

// ========== EVENT LISTENERS ==========
        document.getElementById('userInput').addEventListener('keydown', function(e) {
            // Shift+Enter = kirim pesan
            if (e.key === 'Enter' && e.shiftKey && !isTyping) {
                e.preventDefault();
                sendMessage();
            }
            // Enter saja = new line (biarkan default behavior)
            // Tidak perlu kode tambahan, textarea akan handle sendiri
        });
        // Performance optimization
        let scrollTimeout;
        window.addEventListener('scroll', function() {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                // Scroll ended
            }, 150);
        }, { passive: true });
        
        // Auto-save chat before closing
        window.addEventListener('beforeunload', function() {
            if (currentChatId) {
                saveCurrentChat();
            }
        });
        // Auto-resize textarea
        const textarea = document.getElementById('userInput');
        textarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });
        // Navigate to 404 page
        function navigateTo404(event) {
            event.preventDefault();
            window.location.href = '404/index.html';
        }
    </script>
</body>
</html>